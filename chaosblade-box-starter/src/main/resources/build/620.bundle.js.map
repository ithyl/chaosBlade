{"version":3,"file":"620.bundle.js","sources":["../620.bundle.js"],"sourcesContent":["(self[\"webpackChunk\"] = self[\"webpackChunk\"] || []).push([[620],{\n\n/***/ 39620:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var _typeof = __webpack_require__(24596);\n\nvar _Object$defineProperty = __webpack_require__(67394);\n\nvar _WeakMap = __webpack_require__(93168);\n\nvar _Object$getOwnPropertyDescriptor = __webpack_require__(23587);\n\nvar _Object$keys = __webpack_require__(83452);\n\nvar _Object$getOwnPropertySymbols = __webpack_require__(95315);\n\nvar _Object$getOwnPropertyDescriptors = __webpack_require__(63774);\n\nvar _Object$defineProperties = __webpack_require__(92937);\n\n(function (global, factory) {\n  if (true) {\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports, __webpack_require__(12955), __webpack_require__(93080), __webpack_require__(72153), __webpack_require__(28757), __webpack_require__(15286), __webpack_require__(17534), __webpack_require__(77809), __webpack_require__(57379), __webpack_require__(88162), __webpack_require__(81853), __webpack_require__(30553), __webpack_require__(8583), __webpack_require__(27378), __webpack_require__(66697), __webpack_require__(98784), __webpack_require__(14798), __webpack_require__(68055), __webpack_require__(13988), __webpack_require__(99328), __webpack_require__(14870), __webpack_require__(19000)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else { var mod; }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_exports, _dialog, _extends2, _button, _select, _input, _message, _asyncToGenerator2, _defineProperty2, _field, _slicedToArray2, _radio, _form, _react, _Translation, _lodash, _i18n, _locale, _index, _sreUtils, _sreUtilsDva, _CustomSelect) {\n  \"use strict\";\n\n  var _interopRequireDefault = __webpack_require__(67971);\n\n  _Object$defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n\n  _exports[\"default\"] = void 0;\n  _dialog = _interopRequireDefault(_dialog);\n  _extends2 = _interopRequireDefault(_extends2);\n  _button = _interopRequireDefault(_button);\n  _select = _interopRequireDefault(_select);\n  _input = _interopRequireDefault(_input);\n  _message = _interopRequireDefault(_message);\n  _asyncToGenerator2 = _interopRequireDefault(_asyncToGenerator2);\n  _defineProperty2 = _interopRequireDefault(_defineProperty2);\n  _field = _interopRequireDefault(_field);\n  _slicedToArray2 = _interopRequireDefault(_slicedToArray2);\n  _radio = _interopRequireDefault(_radio);\n  _form = _interopRequireDefault(_form);\n  _react = _interopRequireWildcard(_react);\n  _Translation = _interopRequireDefault(_Translation);\n  _lodash = _interopRequireDefault(_lodash);\n  _i18n = _interopRequireDefault(_i18n);\n  _locale = _interopRequireDefault(_locale);\n  _index = _interopRequireDefault(_index);\n  _CustomSelect = _interopRequireDefault(_CustomSelect);\n\n  function _getRequireWildcardCache(nodeInterop) { if (typeof _WeakMap !== \"function\") return null; var cacheBabelInterop = new _WeakMap(); var cacheNodeInterop = new _WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\n  function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = _Object$defineProperty && _Object$getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? _Object$getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { _Object$defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n  function ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n  var FormItem = _form[\"default\"].Item;\n  var formItemLayout = {\n    labelCol: {\n      fixedSpan: 6\n    },\n    wrapperCol: {\n      span: 18\n    }\n  };\n  var RadioGroup = _radio[\"default\"].Group;\n\n  var Index = function Index(_ref) {\n    var onClose = _ref.onClose;\n    var dispatch = (0, _sreUtilsDva.useDispatch)();\n\n    var _useState = (0, _react.useState)([]),\n        _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n        haveGroupList = _useState2[0],\n        setHaveGroupList = _useState2[1]; // 分组数据\n\n\n    var _useState3 = (0, _react.useState)(false),\n        _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n        loading = _useState4[0],\n        setLoading = _useState4[1]; // 提交数据loading\n\n\n    var field = _field[\"default\"].useField();\n\n    var _useState5 = (0, _react.useState)({\n      appType: 1\n    }),\n        _useState6 = (0, _slicedToArray2[\"default\"])(_useState5, 2),\n        fieldValues = _useState6[0],\n        setFieldValues = _useState6[1];\n\n    var _useState7 = (0, _react.useState)(null),\n        _useState8 = (0, _slicedToArray2[\"default\"])(_useState7, 2),\n        currApp = _useState8[0],\n        setCurrApp = _useState8[1];\n\n    (0, _react.useEffect)(function () {\n      setFieldValues(_objectSpread(_objectSpread({}, fieldValues), {}, {\n        AppName: undefined,\n        AppGroupName: undefined\n      }));\n    }, [fieldValues === null || fieldValues === void 0 ? void 0 : fieldValues.appType]);\n    (0, _react.useEffect)(function () {\n      var getAppGroup = /*#__PURE__*/function () {\n        var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n          var _ref3, _getParams;\n\n          var namespace, args, _yield$dispatch$agent, _yield$dispatch$agent2, res;\n\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  namespace = (_ref3 = (_getParams = (0, _sreUtils.getParams)('ns')) !== null && _getParams !== void 0 ? _getParams : window.curNamespace) !== null && _ref3 !== void 0 ? _ref3 : 'default';\n                  args = {\n                    namespace: namespace,\n                    region: (0, _sreUtils.getActiveRegion)(),\n                    appType: '0'\n                  };\n\n                  if (currApp) {\n                    args.app_id = currApp.app_id;\n                  }\n\n                  _context.next = 5;\n                  return dispatch.agentSetting.getGetUserApplicationGroups(args);\n\n                case 5:\n                  _yield$dispatch$agent = _context.sent;\n                  _yield$dispatch$agent2 = _yield$dispatch$agent.Data;\n                  res = _yield$dispatch$agent2 === void 0 ? [] : _yield$dispatch$agent2;\n                  setHaveGroupList(res);\n\n                case 9:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function getAppGroup() {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      if (fieldValues !== null && fieldValues !== void 0 && fieldValues.AppName && (fieldValues === null || fieldValues === void 0 ? void 0 : fieldValues.appType) === 1) {\n        setHaveGroupList([]);\n        getAppGroup();\n      }\n    }, [currApp === null || currApp === void 0 ? void 0 : currApp.app_id]);\n\n    var onOkSubmit = /*#__PURE__*/function () {\n      var _ref4 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(values) {\n        var params, _yield$dispatch$agent3, _yield$dispatch$agent4, Data, _yield$dispatch$agent5, Code, msg;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                setLoading(true);\n                params = _lodash[\"default\"].cloneDeep(values);\n\n                if (params.appType === 1) {\n                  params.AppName = currApp === null || currApp === void 0 ? void 0 : currApp.app_name;\n                  params.AppId = currApp === null || currApp === void 0 ? void 0 : currApp.app_id;\n                }\n\n                delete params.appType;\n                _context2.next = 6;\n                return dispatch.agentSetting.getInstallPlugin(params);\n\n              case 6:\n                _yield$dispatch$agent3 = _context2.sent;\n                _yield$dispatch$agent4 = _yield$dispatch$agent3.Data;\n                Data = _yield$dispatch$agent4 === void 0 ? false : _yield$dispatch$agent4;\n                _yield$dispatch$agent5 = _yield$dispatch$agent3.Code;\n                Code = _yield$dispatch$agent5 === void 0 ? '' : _yield$dispatch$agent5;\n                setLoading(false);\n\n                if (Data) {\n                  _message[\"default\"].success(_i18n[\"default\"].t('The probe is being installed, this may take a few minutes, please check later...'));\n\n                  onClose();\n                } else {\n                  msg = _i18n[\"default\"].t('The automatic installation of the probe failed, please try to install it manually');\n\n                  if (Code === 'plugin.instance.not.exist') {\n                    msg = _i18n[\"default\"].t('The current instance does not exist, please select an available instance');\n                  }\n\n                  _message[\"default\"].error(msg);\n                }\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function onOkSubmit(_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    var checkField = function checkField(rule, value, callback, field) {\n      if (field === 'InstanceId' && /^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$/.test(value) === false) {\n        callback(_i18n[\"default\"].t('Please fill in the legitimate machine IP address'));\n      } else if (field === 'SshPort' && !(/^[1-9]\\d*$/.test(value) && Number(value) >= 1 && Number(value) <= 65535)) {\n        callback(_i18n[\"default\"].t('Please fill in valid port'));\n      } else if (['AppName', 'AppGroupName'].includes(field) && /^[\\w|\\||-]*$/g.test(value) === false) {\n        callback(\"\".concat(_i18n[\"default\"].t('Please fill in legal'), \"\\b\").concat(field === 'AppName' ? _i18n[\"default\"].t('Application') : _i18n[\"default\"].t('Group')).concat(_i18n[\"default\"].t('Name')));\n      } else {\n        callback();\n      }\n    };\n\n    return /*#__PURE__*/_react[\"default\"].createElement(_dialog[\"default\"], {\n      visible: true,\n      title: _i18n[\"default\"].t('Install the probe').toString(),\n      style: {\n        width: '680px'\n      },\n      okProps: {\n        children: _i18n[\"default\"].t('Install').toString()\n      },\n      footer: false,\n      onCancel: onClose,\n      onClose: onClose,\n      locale: (0, _locale[\"default\"])().Dialog\n    }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n      className: _index[\"default\"].installDialog\n    }, /*#__PURE__*/_react[\"default\"].createElement(_form[\"default\"], (0, _extends2[\"default\"])({}, formItemLayout, {\n      field: field,\n      onChange: function onChange(values) {\n        setFieldValues(values);\n      }\n    }), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      required: true,\n      label: _i18n[\"default\"].t('Application').toString()\n    }, /*#__PURE__*/_react[\"default\"].createElement(RadioGroup, {\n      name: \"appType\",\n      defaultValue: fieldValues.appType\n    }, /*#__PURE__*/_react[\"default\"].createElement(_radio[\"default\"], {\n      value: 1\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Translation[\"default\"], null, \"Existing application\")), /*#__PURE__*/_react[\"default\"].createElement(_radio[\"default\"], {\n      value: 2\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Translation[\"default\"], null, \"Add application\")))), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      label: _i18n[\"default\"].t('Choose application').toString(),\n      required: true\n    }, fieldValues.appType === 1 && /*#__PURE__*/_react[\"default\"].createElement(_CustomSelect[\"default\"], {\n      params: {\n        filterDisabled: true,\n        appType: 0\n      },\n      placeholder: _i18n[\"default\"].t('Please select an app name').toString(),\n      name: \"AppName\",\n      value: fieldValues.AppName,\n      onChange: function onChange(value, action, item) {\n        // setFieldValues({ ...fieldValues, _AppName: item.app_name });\n        setCurrApp(item);\n      }\n    }) || /*#__PURE__*/_react[\"default\"].createElement(_input[\"default\"], {\n      value: fieldValues.AppName,\n      placeholder: _i18n[\"default\"].t('Please input application name').toString(),\n      name: \"AppName\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      label: _i18n[\"default\"].t('Application group').toString() // required\n      ,\n      validator: function validator(rule, value, callback) {\n        return checkField(rule, value, callback, 'AppGroupName');\n      }\n    }, fieldValues.appType === 1 && /*#__PURE__*/_react[\"default\"].createElement(_select[\"default\"], {\n      showSearch: true,\n      value: fieldValues.AppGroupName,\n      style: {\n        width: '100%'\n      },\n      dataSource: haveGroupList,\n      placeholder: _i18n[\"default\"].t('Please select an app group'),\n      name: \"AppGroupName\",\n      locale: (0, _locale[\"default\"])().Select\n    }) || /*#__PURE__*/_react[\"default\"].createElement(_input[\"default\"], {\n      value: fieldValues.AppGroupName,\n      placeholder: _i18n[\"default\"].t('Please input application group').toString(),\n      name: \"AppGroupName\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      label: _i18n[\"default\"].t('IP').toString(),\n      required: true,\n      validator: function validator(rule, value, callback) {\n        return checkField(rule, value, callback, 'InstanceId');\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_input[\"default\"], {\n      placeholder: _i18n[\"default\"].t('Please input the machine ip').toString(),\n      name: \"InstanceId\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      label: _i18n[\"default\"].t('port').toString(),\n      validator: function validator(rule, value, callback) {\n        return checkField(rule, value, callback, 'SshPort');\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_input[\"default\"], {\n      placeholder: _i18n[\"default\"].t('Please enter the port'),\n      name: \"SshPort\",\n      defaultValue: 22\n    })), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      label: _i18n[\"default\"].t('SSH user').toString(),\n      required: true,\n      validator: function validator(rule, value, callback) {\n        return checkField(rule, value, callback, 'SshUser');\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_input[\"default\"], {\n      placeholder: _i18n[\"default\"].t('Please enter SSH user').toString(),\n      name: \"SshUser\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(FormItem, {\n      label: _i18n[\"default\"].t('SSH password').toString() // required\n      // validator={(rule, value, callback) => checkField(rule, value, callback, 'SshPassword')}\n\n    }, /*#__PURE__*/_react[\"default\"].createElement(_input[\"default\"], {\n      htmlType: \"password\",\n      placeholder: _i18n[\"default\"].t('Please enter SSH password').toString(),\n      name: \"SshPassword\"\n    })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n      style: {\n        textAlign: 'right'\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_form[\"default\"].Submit, {\n      validate: true,\n      type: \"primary\",\n      loading: loading,\n      onClick: function onClick(value) {\n        return onOkSubmit(value);\n      },\n      style: {\n        marginRight: 10\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Translation[\"default\"], null, \"Install\")), /*#__PURE__*/_react[\"default\"].createElement(_button[\"default\"], {\n      onClick: function onClick() {\n        return onClose();\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Translation[\"default\"], null, \"cancel\"))))));\n  };\n\n  var _default = /*#__PURE__*/(0, _react.memo)(Index);\n\n  _exports[\"default\"] = _default;\n});\n\n/***/ }),\n\n/***/ 86901:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n\"use strict\";\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Z\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60994);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(93476);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".index__installDialog__bDteq label:before {\\n    margin-right: 4px;\\n    content: \\\" \\\";\\n    display: inline-block;\\n    width: 6px;\\n  }\", \"\",{\"version\":3,\"sources\":[\"webpack://./pages/Manage/AutoInstall/index.css\"],\"names\":[],\"mappings\":\"AACE;IACE,iBAAiB;IACjB,YAAY;IACZ,qBAAqB;IACrB,UAAU;EACZ\",\"sourcesContent\":[\".installDialog {\\n  label:before {\\n    margin-right: 4px;\\n    content: \\\" \\\";\\n    display: inline-block;\\n    width: 6px;\\n  } \\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"installDialog\": \"index__installDialog__bDteq\"\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 13988:\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1892);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_modules_typescript_loader_index_js_node_modules_css_loader_dist_cjs_js_ruleSet_1_rules_0_oneOf_3_use_2_node_modules_postcss_loader_dist_cjs_js_index_css_css_modules__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86901);\n\n            \n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_modules_typescript_loader_index_js_node_modules_css_loader_dist_cjs_js_ruleSet_1_rules_0_oneOf_3_use_2_node_modules_postcss_loader_dist_cjs_js_index_css_css_modules__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .Z, options);\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_modules_typescript_loader_index_js_node_modules_css_loader_dist_cjs_js_ruleSet_1_rules_0_oneOf_3_use_2_node_modules_postcss_loader_dist_cjs_js_index_css_css_modules__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"].locals */ .Z.locals || {});\n\n/***/ })\n\n}]);"],"mappings":"AAAA;AA0XA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;","sourceRoot":""}